---
title: Machine Learning Studio (經典版) 實驗
description: 在 Dynamics 365 Customer Insights 中使用 Azure Machine Learning Studio (經典版) 模型。
ms.date: 12/03/2020
ms.service: customer-insights
ms.subservice: audience-insights
ms.topic: conceptual
author: m-hartmann
ms.author: mhart
ms.reviewer: ameetj
manager: shellyha
ms.openlocfilehash: 556b6810db0ed2733a3f086291757bd85b77e371
ms.sourcegitcommit: a9b2cf598f256d07a48bba8617347ee90024a1dd
ms.translationtype: HT
ms.contentlocale: zh-HK
ms.lasthandoff: 12/03/2020
ms.locfileid: "4669045"
---
# <a name="use-models-based-on-azure-machine-learning-studio-classic"></a><span data-ttu-id="8b971-103">根據 Azure Machine Learning Studio (經典版) 基礎使用各模型</span><span class="sxs-lookup"><span data-stu-id="8b971-103">Use models based on Azure Machine Learning Studio (classic)</span></span>

<span data-ttu-id="8b971-104">Dynamics 365 Customer Insights 中的統一資料是組建可產生額外業務見解的機器學習模型來源。</span><span class="sxs-lookup"><span data-stu-id="8b971-104">The unified data in Dynamics 365 Customer Insights is a source for building machine learning models that can generate additional business insights.</span></span> <span data-ttu-id="8b971-105">整合 Customer Insights 和 Machine Learning Studio (經典版) 使用您自己的自訂模型。</span><span class="sxs-lookup"><span data-stu-id="8b971-105">Customer Insights integrates with Machine Learning Studio (classic) to use your own custom models.</span></span> <span data-ttu-id="8b971-106">若要瞭解 Azure Machine 中開發的模型如何整合 Customer Insights，請見 [Azure Machine Learning 實驗](azure-machine-learning-experiments.md)。</span><span class="sxs-lookup"><span data-stu-id="8b971-106">To see how models developed in Azure Machine Learning are integrated with Customer Insights, see [Azure Machine Learning experiments](azure-machine-learning-experiments.md).</span></span>

## <a name="prerequisites"></a><span data-ttu-id="8b971-107">先決條件</span><span class="sxs-lookup"><span data-stu-id="8b971-107">Prerequisites</span></span>

- <span data-ttu-id="8b971-108">存取 Customer Insights</span><span class="sxs-lookup"><span data-stu-id="8b971-108">Access to Customer Insights</span></span>
- <span data-ttu-id="8b971-109">有效的 Azure 企業版訂用帳戶</span><span class="sxs-lookup"><span data-stu-id="8b971-109">Active Azure Enterprise subscription</span></span>
- [<span data-ttu-id="8b971-110">統整的客戶設定檔</span><span class="sxs-lookup"><span data-stu-id="8b971-110">Unified customer profiles</span></span>](data-unification.md)
- <span data-ttu-id="8b971-111">[對 Azure Blob 儲存體的實體匯出](export-azure-blob-storage.md)設定</span><span class="sxs-lookup"><span data-stu-id="8b971-111">[Entity export to Azure Blob storage](export-azure-blob-storage.md) set up</span></span>

## <a name="set-up-machine-learning-studio-classic"></a><span data-ttu-id="8b971-112">設定 Machine Learning Studio 經典版</span><span class="sxs-lookup"><span data-stu-id="8b971-112">Set up Machine Learning Studio Classic</span></span>

<span data-ttu-id="8b971-113">在步驟一中，我們必須建立 Machine Learning Studio (經典版) 工作區並打開它。</span><span class="sxs-lookup"><span data-stu-id="8b971-113">In a first step, we need to create a workspace for and open the Machine Learning Studio (classic).</span></span>

1. <span data-ttu-id="8b971-114">前往 [https://www.portal.azure.com](https://www.portal.azure.com/) 並登入。</span><span class="sxs-lookup"><span data-stu-id="8b971-114">Go to [https://www.portal.azure.com](https://www.portal.azure.com/) and sign in.</span></span>

1. <span data-ttu-id="8b971-115">選取 **建立資源**。</span><span class="sxs-lookup"><span data-stu-id="8b971-115">Select **Create a resource**.</span></span>

1. <span data-ttu-id="8b971-116">搜尋 **Machine Learning Studio 工作區** 並選取 **建立**。</span><span class="sxs-lookup"><span data-stu-id="8b971-116">Search **Machine Learning Studio Workspace** and select **Create**.</span></span>

1. <span data-ttu-id="8b971-117">輸入[建立工作區](https://docs.microsoft.com/azure/machine-learning/studio/create-workspace)所需的詳細資料。</span><span class="sxs-lookup"><span data-stu-id="8b971-117">Enter the required details to [create the workspace](https://docs.microsoft.com/azure/machine-learning/studio/create-workspace).</span></span> <span data-ttu-id="8b971-118">根據您計畫匯入的資料量選擇 **Web 服務計畫價格層級**。</span><span class="sxs-lookup"><span data-stu-id="8b971-118">Choose the **Web service plan pricing tier** based on the amount of data you plan to import.</span></span> <span data-ttu-id="8b971-119">為了取得最佳效能，請選取地理上距離您最近的 **位置**。</span><span class="sxs-lookup"><span data-stu-id="8b971-119">For best performance, select the **Location** that is geographically closest to you.</span></span>

1. <span data-ttu-id="8b971-120">建立資源之後，Machine Learning Studio 工作區儀表板會出現。</span><span class="sxs-lookup"><span data-stu-id="8b971-120">After creating the resource, the Machine Learning Studio workspace dashboard will appear.</span></span> <span data-ttu-id="8b971-121">選取 **啟動 Machine Learning Studio**。</span><span class="sxs-lookup"><span data-stu-id="8b971-121">Select **Launch Machine Learning Studio**.</span></span>

   ![Azure Machine Learning Studio 使用者介面](media/azure-machine-learning-studio.png)

## <a name="work-with-azure-machine-learning-studio"></a><span data-ttu-id="8b971-123">使用 Azure Machine Learning Studio</span><span class="sxs-lookup"><span data-stu-id="8b971-123">Work with Azure Machine Learning Studio</span></span>

<span data-ttu-id="8b971-124">您現在可以建立新實驗，或從範例庫匯入現有的實驗範本。</span><span class="sxs-lookup"><span data-stu-id="8b971-124">You can now create a new experiment, or import an existing experiment template from the sample gallery.</span></span> <span data-ttu-id="8b971-125">目前三種標準案例均有實驗範例：</span><span class="sxs-lookup"><span data-stu-id="8b971-125">There are sample experiments for three standard scenarios:</span></span>

- [<span data-ttu-id="8b971-126">流失預測</span><span class="sxs-lookup"><span data-stu-id="8b971-126">Churn prediction</span></span>](#churn-analysis)

- [<span data-ttu-id="8b971-127">客戶存留期數值</span><span class="sxs-lookup"><span data-stu-id="8b971-127">Customer lifetime value</span></span>](#customer-lifetime-value-prediction)

- [<span data-ttu-id="8b971-128">產品建議或下一步最佳動作</span><span class="sxs-lookup"><span data-stu-id="8b971-128">Product recommendation or next best action</span></span>](#productrecommendation-or-next-best-action)

1. <span data-ttu-id="8b971-129">如果您建立新實驗，或使用資料庫中的實驗範本，則必須設定 **匯入資料** 屬性。</span><span class="sxs-lookup"><span data-stu-id="8b971-129">If you create a new experiment or use an experiment template from the gallery, you need to configure the **Import Data** properties.</span></span> <span data-ttu-id="8b971-130">請使用引導式體驗或直接提供詳細資料存取包含資料的 Azure Blob 儲存體。</span><span class="sxs-lookup"><span data-stu-id="8b971-130">Use the guided experience or directly provide details to access the Azure Blob Storage that contains your data.</span></span>  

   ![Azure Machine Learning Studio 實驗](media/azure-machine-learning-studio-experiment.png)

1. <span data-ttu-id="8b971-132">現在您可以建置自訂處理管線，以清理並預先處理資料、擷取功能，以及定型適當模型。</span><span class="sxs-lookup"><span data-stu-id="8b971-132">Now you can build a custom processing pipeline to clean and preprocess the data, extract features, and train a suitable model.</span></span>

1. <span data-ttu-id="8b971-133">測試和最佳化模型效能。</span><span class="sxs-lookup"><span data-stu-id="8b971-133">Test and optimize the model performance.</span></span>

1. <span data-ttu-id="8b971-134">當您滿意模型的品質時，選取 **設定 Web 服務** > **預測型 Web 服務**。</span><span class="sxs-lookup"><span data-stu-id="8b971-134">When you’re satisfied with the quality of a model, select **Set up web service** > **Predictive Web Service**.</span></span> <span data-ttu-id="8b971-135">此選項會將已定型模型與特徵化管線從定型實驗匯入至預測服務。</span><span class="sxs-lookup"><span data-stu-id="8b971-135">This option imports the trained model and the featurization pipeline from the training experiment to a predictive service.</span></span> <span data-ttu-id="8b971-136">預測服務可以透過定型實驗中使用的結構描述，接受另一組輸入資料。</span><span class="sxs-lookup"><span data-stu-id="8b971-136">The predictive service can take another set of input data with the schema used in the training experiment to make predictions.</span></span>

   ![設定預測型 Web 服務](media/predictive-webservice-control.png)

1. <span data-ttu-id="8b971-138">預測型 Web 服務實驗成功完成後，就可以將其部署作自動排程之用。</span><span class="sxs-lookup"><span data-stu-id="8b971-138">Once the predictive web service experiment is successful, you can deploy it for auto scheduling.</span></span> <span data-ttu-id="8b971-139">若要讓 Web 服務與 Customer Insights 搭配使用，請選取 **部署 Web 服務** > **部署 Web 服務 [新增] 預覽**。</span><span class="sxs-lookup"><span data-stu-id="8b971-139">To have the web service work with Customer Insights, select **Deploy Web Service** > **Deploy Web Service [New] Preview**.</span></span> <span data-ttu-id="8b971-140">[進一步了解部署 Web 服務](https://docs.microsoft.com/azure/machine-learning/studio/deploy-a-machine-learning-web-service)。</span><span class="sxs-lookup"><span data-stu-id="8b971-140">[Learn more about deploying a web service](https://docs.microsoft.com/azure/machine-learning/studio/deploy-a-machine-learning-web-service).</span></span>

   ![部署預測型 Web 服務](media/predictive-webservice-deploy.png)

## <a name="sample-models-from-the-gallery"></a><span data-ttu-id="8b971-142">資源庫中的範例模型</span><span class="sxs-lookup"><span data-stu-id="8b971-142">Sample models from the gallery</span></span>

<span data-ttu-id="8b971-143">本文會為模型使用 Contoso 飯店的虛構案例。</span><span class="sxs-lookup"><span data-stu-id="8b971-143">We'll use a fictitious scenario of Contoso Hotel for the models in this article.</span></span> <span data-ttu-id="8b971-144">Contoso 飯店收集下列資料：</span><span class="sxs-lookup"><span data-stu-id="8b971-144">Contoso Hotel gathers the following data:</span></span>

- <span data-ttu-id="8b971-145">包含飯店住宿活動的 CRM 資料。</span><span class="sxs-lookup"><span data-stu-id="8b971-145">CRM data consisting of hotel stay activity.</span></span> <span data-ttu-id="8b971-146">資料集包含每個已登記客戶的住宿日期資訊。</span><span class="sxs-lookup"><span data-stu-id="8b971-146">The data set includes information about the dates of stay for each registered customer.</span></span> <span data-ttu-id="8b971-147">其中也包含預訂、房間類型、消費明細等方面的相關資訊。</span><span class="sxs-lookup"><span data-stu-id="8b971-147">It also contains information about the booking, room types, details of spend, and so on.</span></span> <span data-ttu-id="8b971-148">資料涵蓋從 2014 年 1 月至 2018 年 1 月的四年期間。</span><span class="sxs-lookup"><span data-stu-id="8b971-148">The data spans four years, from January 2014 to January 2018.</span></span>
- <span data-ttu-id="8b971-149">飯店房客的客戶設定檔。</span><span class="sxs-lookup"><span data-stu-id="8b971-149">Customer profiles of hotel guests.</span></span> <span data-ttu-id="8b971-150">這些設定檔包含每個客戶的相關資訊，包括其姓名、生日、郵寄地址、性別和電話號碼。</span><span class="sxs-lookup"><span data-stu-id="8b971-150">These profiles contain information about each customer, including their name, birthdate, postal address, gender, and phone number.</span></span>
- <span data-ttu-id="8b971-151">飯店提供的服務使用項目，例如温泉、洗衣房、WiFi 或快遞。</span><span class="sxs-lookup"><span data-stu-id="8b971-151">Usage of services offered by the hotel, such as the spa, laundry, WiFi, or courier.</span></span> <span data-ttu-id="8b971-152">每個已登記客戶的這些資訊都記錄下來。</span><span class="sxs-lookup"><span data-stu-id="8b971-152">This information is logged for each registered customer.</span></span> <span data-ttu-id="8b971-153">服務的使用通常連結著住宿。</span><span class="sxs-lookup"><span data-stu-id="8b971-153">Typically, use of services is linked with the stay.</span></span> <span data-ttu-id="8b971-154">在某些情況下，客戶未在飯館住宿也能使用服務。</span><span class="sxs-lookup"><span data-stu-id="8b971-154">In some cases, services can be used by customers without staying in the hotel.</span></span>

## <a name="churn-analysis"></a><span data-ttu-id="8b971-155">流失分析</span><span class="sxs-lookup"><span data-stu-id="8b971-155">Churn Analysis</span></span>

<span data-ttu-id="8b971-156">流失分析會套用至不同的業務領域。</span><span class="sxs-lookup"><span data-stu-id="8b971-156">Churn analysis applies to different business areas.</span></span> <span data-ttu-id="8b971-157">在本範例中，我們準備針對上述飯店服務情境查看服務流失情況。</span><span class="sxs-lookup"><span data-stu-id="8b971-157">In this example, we’re going to look at service churn, specifically in the context of hotel services as described above.</span></span> <span data-ttu-id="8b971-158">它提供端對端模型管道的實用範例，可用做其他任何流失模型類型的起點。</span><span class="sxs-lookup"><span data-stu-id="8b971-158">It provides a working example of an end–to–end model pipeline that can be used as a starting point for any other type of churn model.</span></span>

### <a name="definition-of-churn"></a><span data-ttu-id="8b971-159">流失的定義</span><span class="sxs-lookup"><span data-stu-id="8b971-159">Definition of Churn</span></span>

<span data-ttu-id="8b971-160">根據案例而定，流失的定義可能會有所不同。</span><span class="sxs-lookup"><span data-stu-id="8b971-160">The definition of churn can differ based on the scenario.</span></span> <span data-ttu-id="8b971-161">在本範例中，過去一年內尚未親訪飯店的房客應標註為已流失。</span><span class="sxs-lookup"><span data-stu-id="8b971-161">In this example, a guest who hasn’t visited the hotel in the past year should be labeled as churned.</span></span>  

<span data-ttu-id="8b971-162">實驗範本可從資源庫匯入。</span><span class="sxs-lookup"><span data-stu-id="8b971-162">The experiment template can be imported from the gallery.</span></span> <span data-ttu-id="8b971-163">首先，請確保從 Azure Blob 儲存體匯入 **飯店留宿活動**、**客戶資料** 和 **服務使用方式資料** 的資料。</span><span class="sxs-lookup"><span data-stu-id="8b971-163">First, ensure that you import the data for **Hotel Stay Activity**, **Customer data**, and **Service Usage Data** from Azure Blob storage.</span></span>

   ![匯入流失模型的資料](media/import-data-azure-blob-storage.png)

### <a name="featurization"></a><span data-ttu-id="8b971-165">特徵化</span><span class="sxs-lookup"><span data-stu-id="8b971-165">Featurization</span></span>

<span data-ttu-id="8b971-166">根據流失定義，我們先找出將影響標籤的原始特色。</span><span class="sxs-lookup"><span data-stu-id="8b971-166">Based on the definition of churn, we first identify the raw features that will influence the label.</span></span> <span data-ttu-id="8b971-167">然後，將這些原始特徵處理成可用於機器學習模型的數值特徵。</span><span class="sxs-lookup"><span data-stu-id="8b971-167">Then, we process these raw features into numerical features that can be used with machine learning models.</span></span> <span data-ttu-id="8b971-168">資料整合發生於 Customer Insights，因此我們可以使用 *顧客識別碼* 加入這些表格。</span><span class="sxs-lookup"><span data-stu-id="8b971-168">Data integration happens in Customer Insights so we can join these tables by using the *Customer ID*.</span></span>

   ![靈結匯入的資料](media/join-imported-data.png)

<span data-ttu-id="8b971-170">組建流失分析模型的特徵化動作會有一點難以應付。</span><span class="sxs-lookup"><span data-stu-id="8b971-170">The featurization for building the model for churn analysis can be a little tricky.</span></span> <span data-ttu-id="8b971-171">資料是每天所記錄的新飯店活動的時間函數。</span><span class="sxs-lookup"><span data-stu-id="8b971-171">The data is a function of time with new hotel activity recorded on daily basis.</span></span> <span data-ttu-id="8b971-172">進行特徵化時，我們需要從動態資料產生靜態特徵。</span><span class="sxs-lookup"><span data-stu-id="8b971-172">During featurization, we want to generate static features from the dynamic data.</span></span> <span data-ttu-id="8b971-173">在本案例中，我們使用一年的滑動視窗從飯店活動產生多個特徵。</span><span class="sxs-lookup"><span data-stu-id="8b971-173">In this case, we generate multiple features from hotel activity with a sliding window of one year.</span></span> <span data-ttu-id="8b971-174">我們還會將房間類型或預訂類型等分類特徵擴展成使用一位有效編碼的個別特徵。</span><span class="sxs-lookup"><span data-stu-id="8b971-174">We also expand the categorical features like room type or booking type into separate features using one-hot encoding.</span></span>  

<span data-ttu-id="8b971-175">最終特徵清單：</span><span class="sxs-lookup"><span data-stu-id="8b971-175">Final list of features:</span></span>

| <span data-ttu-id="8b971-176">**數字**</span><span class="sxs-lookup"><span data-stu-id="8b971-176">**Number**</span></span>  | <span data-ttu-id="8b971-177">**原始資料行**</span><span class="sxs-lookup"><span data-stu-id="8b971-177">**Original_Column**</span></span>          | <span data-ttu-id="8b971-178">**衍生特徵**</span><span class="sxs-lookup"><span data-stu-id="8b971-178">**Derived Features**</span></span>                                                                                                                      |
|-------------|------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="8b971-179">1</span><span class="sxs-lookup"><span data-stu-id="8b971-179">1</span></span>           | <span data-ttu-id="8b971-180">房間類型</span><span class="sxs-lookup"><span data-stu-id="8b971-180">Room Type</span></span>                    | <span data-ttu-id="8b971-181">RoomTypeLargeCount, RoomTypeSmallCount</span><span class="sxs-lookup"><span data-stu-id="8b971-181">RoomTypeLargeCount, RoomTypeSmallCount</span></span>                                                                                                    |
| <span data-ttu-id="8b971-182">2</span><span class="sxs-lookup"><span data-stu-id="8b971-182">2</span></span>           | <span data-ttu-id="8b971-183">預約類型</span><span class="sxs-lookup"><span data-stu-id="8b971-183">Booking Type</span></span>                 | <span data-ttu-id="8b971-184">BookingTypeOnlineCount, BookingTypePhoneCallCount</span><span class="sxs-lookup"><span data-stu-id="8b971-184">BookingTypeOnlineCount, BookingTypePhoneCallCount</span></span>                                                                                         |
| <span data-ttu-id="8b971-185">3</span><span class="sxs-lookup"><span data-stu-id="8b971-185">3</span></span>           | <span data-ttu-id="8b971-186">旅遊類別</span><span class="sxs-lookup"><span data-stu-id="8b971-186">Travel Category</span></span>              | <span data-ttu-id="8b971-187">TravelCategoryBusinessCount, TravelCategoryLeisureCount</span><span class="sxs-lookup"><span data-stu-id="8b971-187">TravelCategoryBusinessCount, TravelCategoryLeisureCount</span></span>                                                                                   |
| <span data-ttu-id="8b971-188">4</span><span class="sxs-lookup"><span data-stu-id="8b971-188">4</span></span>           | <span data-ttu-id="8b971-189">消費金額</span><span class="sxs-lookup"><span data-stu-id="8b971-189">Dollars Spent</span></span>                | <span data-ttu-id="8b971-190">TotalDollarSpent</span><span class="sxs-lookup"><span data-stu-id="8b971-190">TotalDollarSpent</span></span>                                                                                                                          |
| <span data-ttu-id="8b971-191">5</span><span class="sxs-lookup"><span data-stu-id="8b971-191">5</span></span>           | <span data-ttu-id="8b971-192">入住和退房日期</span><span class="sxs-lookup"><span data-stu-id="8b971-192">Check-in and Checkout dates</span></span>  | <span data-ttu-id="8b971-193">StayDayCount, StayDayCount2016, StayDayCount2015, StayDayCount2014, StayCount, StayCount2016.</span><span class="sxs-lookup"><span data-stu-id="8b971-193">StayDayCount, StayDayCount2016, StayDayCount2015, StayDayCount2014, StayCount, StayCount2016.</span></span> <span data-ttu-id="8b971-194">StayCount2015、StayCount2014</span><span class="sxs-lookup"><span data-stu-id="8b971-194">StayCount2015, StayCount2014</span></span>                |
| <span data-ttu-id="8b971-195">6</span><span class="sxs-lookup"><span data-stu-id="8b971-195">6</span></span>           | <span data-ttu-id="8b971-196">服務使用項目</span><span class="sxs-lookup"><span data-stu-id="8b971-196">Service Usage</span></span>                | <span data-ttu-id="8b971-197">UsageTenure, ConciergeUsage, CourierUsage, DryCleaningUsage, GymUsage, PhoneUsage, RestaurantUsage, SpaUsage, TelevisionUsage, WifiUsage</span><span class="sxs-lookup"><span data-stu-id="8b971-197">UsageTenure, ConciergeUsage, CourierUsage, DryCleaningUsage, GymUsage, PhoneUsage, RestaurantUsage, SpaUsage, TelevisionUsage, WifiUsage</span></span>  |

### <a name="model-selection"></a><span data-ttu-id="8b971-198">模型選取</span><span class="sxs-lookup"><span data-stu-id="8b971-198">Model selection</span></span>

<span data-ttu-id="8b971-199">現在我們必須選擇要使用的最佳演算法。</span><span class="sxs-lookup"><span data-stu-id="8b971-199">Now we need to choose the optimal algorithm to use.</span></span> <span data-ttu-id="8b971-200">在此案例中，大部分特徵都是以分類特徵為依據。</span><span class="sxs-lookup"><span data-stu-id="8b971-200">In this case, most features are based on categorical features.</span></span> <span data-ttu-id="8b971-201">決策樹模型效果往往不錯。</span><span class="sxs-lookup"><span data-stu-id="8b971-201">Typically, decision tree–based models work well.</span></span> <span data-ttu-id="8b971-202">如果只有數字特徵，神經網路應該是比較好的選擇。</span><span class="sxs-lookup"><span data-stu-id="8b971-202">If there are only numerical features, neural networks could be a better choice.</span></span> <span data-ttu-id="8b971-203">支援向量機器 (SVM) 在此類情形中也是不錯的候選模型，但這需要進行大量調整才能取得最佳效能。</span><span class="sxs-lookup"><span data-stu-id="8b971-203">Support vector machine (SVM) also is a good candidate in such situations; however, it needs quite a bit of tuning to extract the best performance.</span></span> <span data-ttu-id="8b971-204">我們選擇 **二元促進式決策樹** 做為首選模型，接著再將 **二元 SVM** 用做第二種模型。</span><span class="sxs-lookup"><span data-stu-id="8b971-204">We choose **Two-Class Boosted Decision Tree** as the first model of choice followed by **Two-Class SVM** as the second model.</span></span> <span data-ttu-id="8b971-205">Azure Machine Learning Studio 讓您進行 A/B 測試，因此最好一開始就使用兩種模型 (而非一種)。</span><span class="sxs-lookup"><span data-stu-id="8b971-205">Azure Machine Learning Studio lets you do A/B testing, so it’s beneficial to start with two models rather than one.</span></span>

<span data-ttu-id="8b971-206">下圖顯示 Azure Machine Learning Studio 提供的模型定型和評估管線：</span><span class="sxs-lookup"><span data-stu-id="8b971-206">The following image shows the model training and evaluation pipeline from Azure Machine Learning Studio:</span></span>

![Azure Machine Learning Studio 中的流失模型](media/azure-machine-learning-model.png)

<span data-ttu-id="8b971-208">我們也套用一種稱為 **排列特徵重要性** 的技術，這是模型最佳化的重要層面。</span><span class="sxs-lookup"><span data-stu-id="8b971-208">We also apply a technique called **Permutation Feature Importance**, an important aspect of model optimization.</span></span> <span data-ttu-id="8b971-209">內建模型對最終預測從任何特定特徵所受的影響知之甚微。</span><span class="sxs-lookup"><span data-stu-id="8b971-209">Built-in models have little to no insight into the impact of any specific feature on the final prediction.</span></span> <span data-ttu-id="8b971-210">特徵重要性計算機使用的是自訂演算法，可運算個別特徵對特定模型結果產生的影響。</span><span class="sxs-lookup"><span data-stu-id="8b971-210">The feature importance calculator uses a custom algorithm to compute the influence of individual features on the outcome for a specific model.</span></span> <span data-ttu-id="8b971-211">特徵重要性已標準化為介於 + 1 到 -1 之間。</span><span class="sxs-lookup"><span data-stu-id="8b971-211">The feature importance is normalized between +1 to -1.</span></span> <span data-ttu-id="8b971-212">負值影響代表對應的特徵對結果有違反常理的影響，應該從模型移除。</span><span class="sxs-lookup"><span data-stu-id="8b971-212">A negative influence means the corresponding feature has counter-intuitive influence on the outcome and should be removed from the model.</span></span> <span data-ttu-id="8b971-213">正值影響表示此特徵對預測造成很大的影響。</span><span class="sxs-lookup"><span data-stu-id="8b971-213">A positive influence indicates the feature is contributing heavily towards the prediction.</span></span> <span data-ttu-id="8b971-214">因為是不同的計量，這些值並非相關係數。</span><span class="sxs-lookup"><span data-stu-id="8b971-214">These values aren't correlation coefficients as they are different metrics.</span></span> <span data-ttu-id="8b971-215">如需詳細資訊，請見 [排列特徵重要性](https://docs.microsoft.com/azure/machine-learning/studio-module-reference/permutation-feature-importance)。</span><span class="sxs-lookup"><span data-stu-id="8b971-215">For more information, see [Permutation Feature Importance](https://docs.microsoft.com/azure/machine-learning/studio-module-reference/permutation-feature-importance).</span></span>

<span data-ttu-id="8b971-216">整個 [流失實驗可查詢 Azure AI 資源庫](https://gallery.azure.ai/Experiment/Hotel-Churn-Predictive-Exp)。</span><span class="sxs-lookup"><span data-stu-id="8b971-216">The entire [churn experiment is available in the Azure AI Gallery](https://gallery.azure.ai/Experiment/Hotel-Churn-Predictive-Exp).</span></span>

## <a name="customer-lifetime-value-prediction"></a><span data-ttu-id="8b971-217">客戶存留期值預測</span><span class="sxs-lookup"><span data-stu-id="8b971-217">Customer lifetime value prediction</span></span>

<span data-ttu-id="8b971-218">顧客終身價值 (CLTV) 計算是企業可用來評估與區隔客戶的其中一項關鍵指標。</span><span class="sxs-lookup"><span data-stu-id="8b971-218">The customer lifetime value (CLTV) calculation is one of the key metrics that a business can use to assess and segment its customers.</span></span> <span data-ttu-id="8b971-219">飯店業務方面，了解自己的客戶是關鍵要素。</span><span class="sxs-lookup"><span data-stu-id="8b971-219">For the hotel business, it’s critical to know their customers.</span></span> <span data-ttu-id="8b971-220">例如，了解構成優良客戶的因素是決定性資訊。</span><span class="sxs-lookup"><span data-stu-id="8b971-220">For example, understanding factors that make up good customers is crucial information.</span></span> <span data-ttu-id="8b971-221">這有助於飯店管理部門評估他們需要強調的特徵，並著手改善以滿足高消費型客戶。</span><span class="sxs-lookup"><span data-stu-id="8b971-221">It helps the hotel management assess which features they need to focus on and improve to satisfy their high paying customers.</span></span> <span data-ttu-id="8b971-222">這些決策可能會對銷售和收益產生直接影響。</span><span class="sxs-lookup"><span data-stu-id="8b971-222">These decisions can have a direct impact on sales and earnings.</span></span>  

### <a name="definition-of-cltv"></a><span data-ttu-id="8b971-223">CLTV 的定義</span><span class="sxs-lookup"><span data-stu-id="8b971-223">Definition of CLTV</span></span>

<span data-ttu-id="8b971-224">本範例中，我們將客戶的 CLTV 值定義為客戶在未來 365 天預計花費的總金額。</span><span class="sxs-lookup"><span data-stu-id="8b971-224">For this example, we define the CLTV of a customer as the total dollar amount the customer is expected to spend in the next 365 days.</span></span> <span data-ttu-id="8b971-225">我們預計使用所有客戶過去整整三年的資料來預測此數值。</span><span class="sxs-lookup"><span data-stu-id="8b971-225">We are going to use the past three years’ worth of data for all customers to predict this value.</span></span>

### <a name="featurization"></a><span data-ttu-id="8b971-226">特徵化</span><span class="sxs-lookup"><span data-stu-id="8b971-226">Featurization</span></span>

<span data-ttu-id="8b971-227">在此案例中，特徵化也將很像流失案例那樣。</span><span class="sxs-lookup"><span data-stu-id="8b971-227">In this case, featurization is going to be quite like the churn scenario.</span></span> <span data-ttu-id="8b971-228">不過標籤和預測值與上方定義值不同。</span><span class="sxs-lookup"><span data-stu-id="8b971-228">However, the labels and predicted values are different than defined above.</span></span>

### <a name="model-selection"></a><span data-ttu-id="8b971-229">模型選取</span><span class="sxs-lookup"><span data-stu-id="8b971-229">Model selection</span></span>

<span data-ttu-id="8b971-230">預測 CLTV 是一項迴歸問題，因為預測值是正值連續變數。</span><span class="sxs-lookup"><span data-stu-id="8b971-230">Predicting the CLTV is a regression problem as the predicted value is a positive valued continuous variable.</span></span> <span data-ttu-id="8b971-231">我們根據特徵屬性將 **促進式決策樹迴歸** 選取為一種演算法，**神經網路迴歸** 則選取為另一種訓練模型演算法。</span><span class="sxs-lookup"><span data-stu-id="8b971-231">Based on the feature properties, we select **Boosted Decision Tree Regression** as one algorithm and **Neural Network Regression** as another algorithm to train the model.</span></span>

## <a name="product-recommendation-or-next-best-action"></a><span data-ttu-id="8b971-232">產品推薦或下一步最佳動作</span><span class="sxs-lookup"><span data-stu-id="8b971-232">Product recommendation or Next Best Action</span></span>

<span data-ttu-id="8b971-233">飯店案例中的產品建議會解釋為推薦飯店提供的服務給客戶。</span><span class="sxs-lookup"><span data-stu-id="8b971-233">Product recommendation in a hotel scenario is interpreted as recommending services offered by the hotel to the customers.</span></span> <span data-ttu-id="8b971-234">目標式是為客戶選擇適當的服務，讓他們的使用量最大化。</span><span class="sxs-lookup"><span data-stu-id="8b971-234">The objective is to choose the appropriate services for customers so that their usage is maximized.</span></span> <span data-ttu-id="8b971-235">這類似於對視訊串流服務使用者的影片建議。</span><span class="sxs-lookup"><span data-stu-id="8b971-235">It’s similar to movie recommendations for video streaming service users.</span></span>

### <a name="definition-of-product-recommendation-or-next-best-action"></a><span data-ttu-id="8b971-236">產品建議或下一步最佳動作的定義</span><span class="sxs-lookup"><span data-stu-id="8b971-236">Definition of Product Recommendation or Next Best Action</span></span>

<span data-ttu-id="8b971-237">我們將目標定義為根據飯店客戶的興趣提供最適配的服務給他們，讓服務消費金額最大化。</span><span class="sxs-lookup"><span data-stu-id="8b971-237">We define the goal as maximizing the dollar amount of service usage by offering the best matching services to hotel customers according to their interest.</span></span>

### <a name="featurization"></a><span data-ttu-id="8b971-238">特徵化</span><span class="sxs-lookup"><span data-stu-id="8b971-238">Featurization</span></span>

<span data-ttu-id="8b971-239">如同流失模型，我們正加入含有 CustomerID 的 ServiceCustomerID，以便按照各 CustomerID 一致性組建推薦產品。</span><span class="sxs-lookup"><span data-stu-id="8b971-239">Like the churn model, we are joining the hotel ServiceCustomerID with CustomerID in order to build recommendations consistently per CustomerID.</span></span>

![建議模型特徵化](media/azure-machine-learning-model-featurization.png)

<span data-ttu-id="8b971-241">資料源自三種不同實體，特徵則由其衍生。</span><span class="sxs-lookup"><span data-stu-id="8b971-241">The data is sourced from three different entities and features are derived from them.</span></span> <span data-ttu-id="8b971-242">與流失及 CLTV 案例相比，建議問題的特徵化有所不同。</span><span class="sxs-lookup"><span data-stu-id="8b971-242">The featurization for the problem of recommendation is different compared to churn or CLTV scenarios.</span></span> <span data-ttu-id="8b971-243">推薦模型需要以三組特徵為資料的輸入格式。</span><span class="sxs-lookup"><span data-stu-id="8b971-243">The recommendation model needs input data in the form of three sets of features.</span></span>

### <a name="model-selection"></a><span data-ttu-id="8b971-244">模型選取</span><span class="sxs-lookup"><span data-stu-id="8b971-244">Model selection</span></span>

<span data-ttu-id="8b971-245">我們使用稱為 **訓練 Matchbox 推薦程式** 的演算法預測產品或服務，藉此訓練推薦模型。</span><span class="sxs-lookup"><span data-stu-id="8b971-245">We predict products or services by using the algorithm called **Train Matchbox Recommender** to train the recommendation model.</span></span>

![產品建議演算法](media/azure-machine-learning-model-recommendation-algorithm.png)

<span data-ttu-id="8b971-247">**訓練 Matchbox 推薦程式** 模型的三個輸入埠納入訓練服務使用方式資料、客戶描述 (非必要) 和服務描述使用。</span><span class="sxs-lookup"><span data-stu-id="8b971-247">The three input ports for the **Train Matchbox Recommender** model takes in the training service usage data, customer description (optional), and service description.</span></span> <span data-ttu-id="8b971-248">目前有三種不同的模型評分方式。</span><span class="sxs-lookup"><span data-stu-id="8b971-248">There are three different ways of scoring the model.</span></span> <span data-ttu-id="8b971-249">其中一種適用模型評估，其間標準化折現累積增益 (Normalized Discounted Cumulative Gain，NDCG) 分數經算出後排列評級項目名次。</span><span class="sxs-lookup"><span data-stu-id="8b971-249">One is for model evaluation where a Normalized Discounted Cumulative Gain (NDCG) score is calculated to rank the rated items.</span></span> <span data-ttu-id="8b971-250">在此實驗中，我們的 NDCG 分數設定為 0.97。</span><span class="sxs-lookup"><span data-stu-id="8b971-250">In this experiment, we have the NDCG score as 0.97.</span></span> <span data-ttu-id="8b971-251">另外兩個選項是針對整個可推薦服務目錄上的模型評分，或只針對使用者未曾使用過的項目評分。</span><span class="sxs-lookup"><span data-stu-id="8b971-251">The other two options are scoring the model on the entire recommendable service catalog, or scoring only on items that users have not used before.</span></span>

<span data-ttu-id="8b971-252">進一步端詳整個服務目錄的推薦分佈情況，我們注意到電話、WiFi 和快遞是預計推薦的前幾項服務。</span><span class="sxs-lookup"><span data-stu-id="8b971-252">Looking further on the distributions of the recommendations on the entire service catalog, we notice that phone, WiFi, and courier are the top services to be recommended.</span></span> <span data-ttu-id="8b971-253">這與我們從服務消費資料的分佈所發現的情況一致：</span><span class="sxs-lookup"><span data-stu-id="8b971-253">This is consistent with what we found from the distributions of the service consumption data:</span></span>

![建議模型輸出](media/azure-machine-learning-model-output.png)

<span data-ttu-id="8b971-255">整個 [產品推薦實驗可在 Azure AI 資源庫存取。](https://gallery.azure.ai/Experiment/Recommendation-4)</span><span class="sxs-lookup"><span data-stu-id="8b971-255">The entire [product recommendation experiment can be accessed in Azure AI Gallery.](https://gallery.azure.ai/Experiment/Recommendation-4)</span></span>

## <a name="integrate-custom-models"></a><span data-ttu-id="8b971-256">整合自訂模型</span><span class="sxs-lookup"><span data-stu-id="8b971-256">Integrate custom models</span></span>

<span data-ttu-id="8b971-257">若要在 Customer Insights 中使用這些預測，您必須連同客戶識別碼一起 **匯出** 預測。</span><span class="sxs-lookup"><span data-stu-id="8b971-257">To use these predictions in Customer Insights, you need to **export** the predictions along with the customer IDs.</span></span> <span data-ttu-id="8b971-258">[將它們匯出到您預計匯出](https://docs.microsoft.com/azure/storage/common/storage-import-export-data-from-blobs) 來源資料的同一個 Azure Blob 儲存體位置。</span><span class="sxs-lookup"><span data-stu-id="8b971-258">[Export them to the same Azure Blob storage location](https://docs.microsoft.com/azure/storage/common/storage-import-export-data-from-blobs) that you export the source data to.</span></span> <span data-ttu-id="8b971-259">您可以將預測型 Web 服務排定為定期執行，並更新分數。</span><span class="sxs-lookup"><span data-stu-id="8b971-259">The predictive web service can be scheduled to run regularly and update the scores.</span></span>

<span data-ttu-id="8b971-260">自訂模型產生的資料可用來進一步富集您的客戶資料。</span><span class="sxs-lookup"><span data-stu-id="8b971-260">Data generated by the custom model can be used to further enrich your customer data.</span></span> <span data-ttu-id="8b971-261">如需詳細資訊，請參閱[自訂機器學習模型](custom-models.md)。</span><span class="sxs-lookup"><span data-stu-id="8b971-261">For more information, see [Custom machine learning models](custom-models.md).</span></span>
